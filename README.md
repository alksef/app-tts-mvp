> **Примечание:** Этот проект полностью написан с помощью Anthropic AI

> **Примечание:** Это MVP-версия, демонстрирующая возможности концепции 

# AppTTS

TTS-приложение для общения с минимальным отвлечением от работы за компьютером.

---

## Проблема

Подробнее: [PROBLEMS.md](PROBLEMS.md)

Люди, использующие синтез речи (TTS) для общения, сталкиваются с тремя основными проблемами:

| Проблема | Последствия |
|----------|-------------|
| **Низкая скорость ввода** | Медленное общение, frustration |
| **Отсутствие интеграции** | Постоянное переключение между окнами, потеря контекста |

Существующие TTS-решения работают изолированно — нужно переключаться между мессенджером/браузером и приложением TTS, запускать воспроизведение. Это прерывает workflow и увеличивает время на общение.

## Решение

**AppTTS** работает незаметно в фоновом режиме и доступен мгновенно по горячей клавише в любом приложении.

Нажали `Win+Esc` — окно появляется поверх активного приложения. Ввели текст — он озвучивается. Нажали снова — окно исчезает, и вы возвращаетесь к работе.

**Где это работает:**
- Мессенджеры (Telegram, WhatsApp, Discord)
- Браузер
- Любое приложение на Windows
- Внутри самого AppTTS

![Главное окно](docs/screenshots/main.png)

---

## Режимы работы

Приложение поддерживает два режима работы, переключаемых в настройках:

### Background Blocking

Классический режим перехвата клавиатуры:
- `Win+Esc` включает/выключает перехват клавиш
- Клавиатура блокируется для всех приложений
- Весь ввод попадает в AppTTS
- Окно появляется при включении (если включён auto-show)

### Overlay Call

Режим быстрого вызова:
- `Win+Esc` показывает/скрывает окно приложения
- Окно появляется поверх активного приложения без always-on-top
- При скрытии окно минимизируется
- Фокус автоматически возвращается в предыдущее окно

---

## Возможности

### Перехват клавиатуры

- **Win+Esc** — переключение режима (или показ/скрытие окна)
- Клавиатура перехватывается в любом приложении
- Динамический хук активируется только при включённом режиме
- **Решение в user-mode** — не требует драйвера ядра
- Отображение перехваченных клавиш в реальном времени
- Автоматическая конвертация раскладки RU/EN
- Учёт Caps Lock при конвертации

### TTS (Text-to-Speech)

**Три провайдера:**

| Провайдер | Описание |
|-----------|----------|
| **System** | Windows SAPI, системные голоса, работает оффлайн |
| **OpenAI** | 13 естественных голосов, требуется API ключ |
| **Localhost** | Локальный HTTP-сервер TTS (например, Silero) |

**Возможности:**
- Непрерывное воспроизведение — авто-озвучка по `. ! ?`
- История сообщений (до 100)
- Повторное воспроизведение фраз
- Блокировка сообщений от удаления
- Очередь с приоритетом

**System TTS:**
- Выбор голоса из списка системных
- Скорость, высота тона, громкость
- *Внимание: может блокировать UI при воспроизведении*

**OpenAI TTS:**
- 13 голосов: alloy, ash, ballad, coral, echo, fable, nova, onyx, sage, shimmer, verse, marin, cedar
- Настройка скорости (0.25-4.0)
- Инструкция для голоса
- Поддержка прокси

### Аудио вывод

**Dual output** — одновременное воспроизведение на два устройства:
- **Динамики** — выбор устройства, громкость, вкл/выкл
- **Виртуальный микрофон** — VB-Cable, VoiceMeeter и др.

*Доступно для OpenAI и Localhost TTS*

### Система плагинов

Расширение функционала через динамические библиотеки (.dll):

- Загрузка плагинов из папки `plugins/`
- Автоматическая генерация UI настроек из JSON Schema
- 5 статусов: OK, не настроен, ошибка подключения, ошибка авторизации, ошибка
- Автоматическое отключение при ошибках
- Отправка текста во все включённые плагины
- Сохранение настроек в `plugins-config.json`

### Управление окном

- **Always-on-Top** — поверх всех окон
- **Auto-show** — авто-показ при включении перехвата
- **Focus restoration** — фокус возвращается в предыдущее окно
- Показ поверх fullscreen приложений
- Игнорирование курсорных событий (прозрачность)

### Раскладка и ввод

- **Переключение RU/EN** — клик на индикатор или `Shift+Alt`
- **Caps Lock** — индикация состояния
- Автоопределение раскладки из системы

---

## Использование

### Базовый сценарий

1. Нажмите **Win+Esc** для включения режима перехвата
2. Вводите текст — он перехватывается в любом приложении
3. Текст автоматически озвучивается по знакам препинания
4. Нажмите **Win+Esc** снова для отключения перехвата

### Горячие клавиши

| Комбинация | Действие |
|------------|----------|
| `Win+Esc` | Включить/выключить перехват (или показать/скрыть окно) |
| `Shift+Alt` | Переключить раскладку RU/EN |
| `Ctrl+Enter` | Отправить текст на TTS |

---

## Технологии

- **Tauri 2.0** — desktop фреймворк
- **Vue.js 3** — UI с Pinia для state management
- **Rust** — backend, low-level keyboard hook
- **Windows API** — WH_KEYBOARD_LL для перехвата клавиш
- **Rodio** — асинхронное MP3 воспроизведение
- **SAPI** — системный TTS

---

## Ограничения

- Только Windows 10/11
- Не перехватывает клавиши от приложений с правами Administrator
- Не может блокировать `Ctrl+Alt+Del` (Secure Desktop)
- System TTS может блокировать UI при воспроизведении

---

## Лицензия

MIT
